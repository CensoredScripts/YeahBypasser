<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yeah Bypasser</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <style>
        :root {
            --bg: #000000;
            --card: #0a0a0a;
            --border: #222222;
            --accent: #ffffff;
            --text: #ffffff;
            --text-dim: #888888;
        }

        body {
            background-color: var(--bg);
            color: var(--text);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        .container {
            background: var(--card);
            padding: 40px;
            border: 1px solid var(--border);
            width: 100%;
            max-width: 700px;
            text-align: center;
        }

        h1 {
            font-size: 2rem;
            margin: 0;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: -1px;
        }

        .subtitle {
            color: var(--text-dim);
            font-size: 0.8rem;
            margin-bottom: 30px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .tabs {
            display: flex;
            border-bottom: 1px solid var(--border);
            margin-bottom: 25px;
        }

        .tab-btn {
            flex: 1;
            background: none;
            border: none;
            color: var(--text-dim);
            padding: 15px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            transition: 0.2s;
        }

        .tab-btn.active {
            color: var(--accent);
            border-bottom: 2px solid var(--accent);
        }

        .section-content { display: none; }
        .section-content.active { display: block; }

        .label {
            font-size: 0.7rem;
            color: var(--text-dim);
            text-transform: uppercase;
            margin-bottom: 12px;
            display: block;
            font-weight: 700;
            letter-spacing: 1px;
        }

        .controls, .sub-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: center;
            margin-bottom: 20px;
        }

        .btn {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-dim);
            padding: 8px 16px;
            cursor: pointer;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            transition: 0.2s;
        }

        .btn:hover { border-color: #444; color: #fff; }
        .btn.active { border-color: var(--accent); color: var(--accent); }

        .bait-section {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid var(--border);
            display: none;
        }

        .upload-row {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }

        .main-btn {
            background: var(--accent);
            color: #000;
            padding: 12px 24px;
            font-weight: 700;
            border: none;
            cursor: pointer;
            text-transform: uppercase;
            font-size: 0.9rem;
        }

        .secondary-btn {
            background: transparent;
            color: #fff;
            border: 1px solid var(--border);
            padding: 12px 24px;
            font-weight: 700;
            cursor: pointer;
            text-transform: uppercase;
            font-size: 0.9rem;
        }

        #filename-tag {
            font-size: 0.75rem;
            color: var(--text-dim);
            margin-bottom: 8px;
            font-family: monospace;
            display: block;
        }

        #preview-area {
            background: #050505;
            padding: 20px;
            border: 1px solid #333; /* Grey border */
            margin-top: 25px;
            display: none;
            max-height: 500px; /* Scaling fix */
            overflow: auto;
        }

        canvas { 
            max-width: 100%; 
            height: auto; 
            display: block; 
            margin: 0 auto;
        }

        #bulk-grid {
            display: none;
            grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
            gap: 10px;
            margin-top: 25px;
            padding: 15px;
            border: 1px solid var(--border);
            max-height: 400px;
            overflow-y: auto;
        }

        .bulk-item { border: 1px solid #222; }

        .action-wrapper { width: 100%; margin-top: 20px; display: none; flex-direction: column; gap: 10px; }

        .export-btn {
            background: #fff;
            color: #000;
            border: none;
            padding: 18px;
            font-weight: 800;
            font-size: 1rem;
            cursor: pointer;
            text-transform: uppercase;
        }

        footer { margin-top: 30px; color: #444; font-size: 0.75rem; font-weight: 600; text-transform: uppercase; }
    </style>
</head>
<body>

<div class="container">
    <h1>Yeah Bypasser</h1>
    <div class="subtitle">Greatly Inspired by Top Bypassing</div>

    <div class="tabs">
        <button class="tab-btn active" onclick="switchTab('decals')">Decals</button>
        <button class="tab-btn" onclick="switchTab('shirts')">Shirts</button>
    </div>

    <div id="decals-section" class="section-content active">
        <span class="label">Methods</span>
        <div class="controls">
            <button class="btn active" onclick="setMode('stretchWide', this)">2000x50 Wide</button>
            <button class="btn" onclick="setMode('stretchTall', this)">200x2100 Tall</button>
            <button class="btn" onclick="setMode('blackOnly', this)">512x512 Black Only</button>
            <button class="btn" onclick="setMode('whiteOnly', this)">512x512 White Only</button>
        </div>
        
        <div id="stretch-options" class="sub-controls">
            <button class="btn" id="convBlack" onclick="toggleConversion('black')">Convert to Black</button>
            <button class="btn" id="convWhite" onclick="toggleConversion('white')">Convert to White</button>
        </div>

        <div id="bait-ui" class="bait-section">
            <span class="label">Baits</span>
            <div class="sub-controls">
                <button class="btn active" onclick="setBait('none', this)">None</button>
                <button class="btn" onclick="setBait('duck', this)">Duck Bait</button>
            </div>
        </div>
    </div>

    <div id="shirts-section" class="section-content">
        <p style="color: var(--text-dim); font-size: 0.85rem; margin-bottom: 25px;">Cleared whites.</p>
    </div>

    <div class="upload-row">
        <label for="upload" class="main-btn">Upload Image</label>
        <button id="bulkToggle" class="secondary-btn" onclick="activateBulk()">Bulk Mode</button>
        <button id="bulkDeactivate" class="secondary-btn" style="display:none; color: #ff4444;" onclick="deactivateBulk()">Disable Bulk</button>
        <input type="file" id="upload" accept="image/*" style="display:none">
    </div>
    
    <div id="preview-area">
        <span id="filename-tag"></span>
        <canvas id="canvas"></canvas>
    </div>

    <div id="bulk-grid"></div>

    <div class="action-wrapper" id="action-wrapper">
        <button id="exportBtn" class="export-btn">Export Image</button>
        <button id="bulkExportBtn" class="export-btn" style="display:none;">Export All (.ZIP)</button>
    </div>
</div>

<footer>Note: Real Life images may not work as well, atleast in Decals.</footer>

<script>
    const upload = document.getElementById('upload');
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const previewArea = document.getElementById('preview-area');
    const filenameTag = document.getElementById('filename-tag');
    const bulkGrid = document.getElementById('bulk-grid');
    const actionWrapper = document.getElementById('action-wrapper');
    const exportBtn = document.getElementById('exportBtn');
    const bulkExportBtn = document.getElementById('bulkExportBtn');
    const bulkDeactivate = document.getElementById('bulkDeactivate');
    const bulkToggle = document.getElementById('bulkToggle');
    const stretchOptions = document.getElementById('stretch-options');
    const baitUi = document.getElementById('bait-ui');
    
    let activeTab = 'decals';
    let currentMode = 'stretchWide';
    let conversionMode = 'none';
    let currentBait = 'none';
    let isBulk = false;
    let imageQueue = [];

    const duckImg = new Image();
    duckImg.crossOrigin = "anonymous";
    duckImg.src = "https://files.catbox.moe/x0zpmq.png";

    function updateVisibility() {
        if (activeTab === 'shirts') {
            baitUi.style.display = 'none';
        } else {
            const hasFilter = currentMode.includes('Only') || conversionMode !== 'none';
            baitUi.style.display = hasFilter ? 'block' : 'none';
        }
    }

    function switchTab(tab) {
        activeTab = tab;
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.querySelector(`.tab-btn[onclick="switchTab('${tab}')"]`).classList.add('active');
        document.getElementById('decals-section').classList.toggle('active', tab === 'decals');
        document.getElementById('shirts-section').classList.toggle('active', tab === 'shirts');
        updateVisibility();
        processQueue();
    }

    function activateBulk() {
        isBulk = true; upload.multiple = true;
        bulkToggle.style.display = 'none'; bulkDeactivate.style.display = 'inline-block';
        previewArea.style.display = 'none'; bulkGrid.style.display = 'grid';
        exportBtn.style.display = 'none'; bulkExportBtn.style.display = 'block';
        processQueue();
    }

    function deactivateBulk() {
        isBulk = false; upload.multiple = false;
        bulkToggle.style.display = 'inline-block'; bulkDeactivate.style.display = 'none';
        bulkGrid.style.display = 'none'; bulkGrid.innerHTML = '';
        imageQueue = imageQueue.slice(0, 1);
        if(imageQueue.length > 0) previewArea.style.display = 'block';
        exportBtn.style.display = 'block'; bulkExportBtn.style.display = 'none';
        processQueue();
    }

    function setMode(mode, btn) {
        currentMode = mode;
        document.querySelectorAll('.controls .btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        stretchOptions.style.display = mode.includes('stretch') ? 'flex' : 'none';
        updateVisibility();
        processQueue();
    }

    function toggleConversion(type) {
        conversionMode = (conversionMode === type) ? 'none' : type;
        document.getElementById('convBlack').classList.toggle('active', conversionMode === 'black');
        document.getElementById('convWhite').classList.toggle('active', conversionMode === 'white');
        updateVisibility();
        processQueue();
    }

    function setBait(baitType, btn) {
        currentBait = baitType;
        document.querySelectorAll('#bait-ui .btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        processQueue();
    }

    upload.addEventListener('change', (e) => {
        const files = Array.from(e.target.files);
        if (!isBulk) imageQueue = [];
        let loaded = 0;
        files.forEach(file => {
            const reader = new FileReader();
            reader.onload = (event) => {
                const img = new Image();
                img.onload = () => {
                    imageQueue.push({img, name: file.name});
                    loaded++;
                    if(loaded === files.length) processQueue();
                };
                img.src = event.target.result;
            };
            reader.readAsDataURL(file);
        });
        e.target.value = '';
    });

    function processQueue() {
        if(imageQueue.length === 0) return;
        actionWrapper.style.display = 'flex';
        if(isBulk) {
            bulkGrid.innerHTML = '';
            imageQueue.forEach(item => {
                const div = document.createElement('div');
                div.className = 'bulk-item';
                const tag = document.createElement('span');
                tag.style.fontSize = '0.6rem'; tag.textContent = item.name;
                const can = document.createElement('canvas');
                div.appendChild(tag); div.appendChild(can);
                bulkGrid.appendChild(div);
                renderToCanvas(item.img, can);
            });
        } else {
            previewArea.style.display = 'block';
            const item = imageQueue[imageQueue.length - 1];
            filenameTag.textContent = item.name;
            renderToCanvas(item.img, canvas);
        }
    }

    function renderToCanvas(img, targetCanvas) {
        const tCtx = targetCanvas.getContext('2d', { willReadFrequently: true });
        if (activeTab === 'shirts') {
            targetCanvas.width = 585; targetCanvas.height = 559;
            const temp = document.createElement('canvas');
            temp.width = 128; temp.height = 128;
            const tempCtx = temp.getContext('2d');
            tempCtx.drawImage(img, 0, 0, 128, 128);
            const idata = tempCtx.getImageData(0, 0, 128, 128);
            const data = idata.data;
            for (let i = 0; i < data.length; i += 4) {
                const maxC = Math.max(data[i], data[i+1], data[i+2]) / 255;
                if (maxC > 0) {
                    data[i] /= maxC; data[i+1] /= maxC; data[i+2] /= maxC;
                    data[i+3] = maxC * data[i+3];
                }
            }
            tempCtx.putImageData(idata, 0, 0);
            tCtx.clearRect(0, 0, 585, 559);
            tCtx.drawImage(temp, 230, 74, 128, 128);
        } else {
            let w = 2000, h = 50;
            if(currentMode === 'stretchTall') { w = 200; h = 2100; }
            if(currentMode.includes('Only')) { w = 512; h = 512; }
            targetCanvas.width = w; targetCanvas.height = h;
            const method = (currentMode.includes('Only')) ? currentMode : conversionMode;
            tCtx.drawImage(img, 0, 0, w, h);
            const idata = tCtx.getImageData(0, 0, w, h);
            const data = idata.data;
            for (let i = 0; i < data.length; i += 4) {
                let avg = (data[i] + data[i+1] + data[i+2]) / 3;
                if (method.includes('black')) {
                    data[i] = 255; data[i+1] = 255; data[i+2] = 255; data[i+3] = avg * 0.7;
                } else if (method.includes('white')) {
                    data[i] = 0; data[i+1] = 0; data[i+2] = 0; data[i+3] = (255 - avg) * 0.7;
                } else { data[i+3] = 130; }
            }
            tCtx.putImageData(idata, 0, 0);
            if (currentBait === 'duck' && (method.includes('black') || method.includes('white'))) {
                tCtx.globalAlpha = 0.2;
                tCtx.drawImage(duckImg, 0, 0, w, h);
                tCtx.globalAlpha = 1.0;
            }
        }
    }

    exportBtn.addEventListener('click', () => {
        const link = document.createElement('a');
        link.download = activeTab === 'shirts' ? 'Shirt_Ghost.png' : 'Decal_Bypass.png';
        link.href = canvas.toDataURL('image/png');
        link.click();
    });

    bulkExportBtn.addEventListener('click', async () => {
        const zip = new JSZip();
        imageQueue.forEach((item, i) => {
            const tempCanvas = document.createElement('canvas');
            renderToCanvas(item.img, tempCanvas);
            zip.file(`Bypassed_${item.name}`, tempCanvas.toDataURL('image/png').split(',')[1], {base64: true});
        });
        const content = await zip.generateAsync({type: "blob"});
        const link = document.createElement('a');
        link.href = URL.createObjectURL(content);
        link.download = "Bypass_Archive.zip";
        link.click();
    });
</script>

</body>
</html>
